cmake_minimum_required(VERSION 3.7)
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
set(OPT_CFLAGS "${OPT_CFLAGS} -DDEBUG")
find_package(DynamoRIO)
if (NOT DynamoRIO_FOUND)
  message(FATAL_ERROR "DynamoRIO package required to build")
endif(NOT DynamoRIO_FOUND)

add_library(peekaboo_dr SHARED "peekaboo_dr.c;peekaboo_utils.c")
configure_DynamoRIO_client(peekaboo_dr)
use_DynamoRIO_extension(peekaboo_dr drmgr)
use_DynamoRIO_extension(peekaboo_dr drreg)
use_DynamoRIO_extension(peekaboo_dr drx)
